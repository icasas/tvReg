<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Time-Varying Generalised Least Squares — tvGLS • tvReg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Time-Varying Generalised Least Squares — tvGLS" />
<meta property="og:description" content="tvGLS estimates time-varying coefficients of SURE using the kernel smoothing GLS.
tvGLS is used to estimate time-varying coefficients SURE using the kernel smoothing
generalised least square." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tvReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tvReg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/icasas/tvReg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Time-Varying Generalised Least Squares</h1>
    <small class="dont-index">Source: <a href='https://github.com/icasas/tvReg/blob/master/R/tvGLS.R'><code>R/tvGLS.R</code></a></small>
    <div class="hidden name"><code>tvGLS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>tvGLS</code> estimates time-varying coefficients of SURE using the kernel smoothing GLS.</p>
<p><code>tvGLS</code> is used to estimate time-varying coefficients SURE using the kernel smoothing
generalised least square.</p>
    </div>

    <pre class="usage"><span class='fu'>tvGLS</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for list</span>
<span class='fu'>tvGLS</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  z <span class='op'>=</span> <span class='cn'>NULL</span>,
  ez <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>bw</span>,
  Sigma <span class='op'>=</span> <span class='cn'>NULL</span>,
  R <span class='op'>=</span> <span class='cn'>NULL</span>,
  r <span class='op'>=</span> <span class='cn'>NULL</span>,
  est <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"lc"</span>, <span class='st'>"ll"</span><span class='op'>)</span>,
  tkernel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Triweight"</span>, <span class='st'>"Epa"</span>, <span class='st'>"Gaussian"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for matrix</span>
<span class='fu'>tvGLS</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  z <span class='op'>=</span> <span class='cn'>NULL</span>,
  ez <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>bw</span>,
  Sigma <span class='op'>=</span> <span class='cn'>NULL</span>,
  R <span class='op'>=</span> <span class='cn'>NULL</span>,
  r <span class='op'>=</span> <span class='cn'>NULL</span>,
  est <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"lc"</span>, <span class='st'>"ll"</span><span class='op'>)</span>,
  tkernel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Triweight"</span>, <span class='st'>"Epa"</span>, <span class='st'>"Gaussian"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for tvsure</span>
<span class='fu'>tvGLS</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object used to select a method.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed to specific methods.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A matrix.</p></td>
    </tr>
    <tr>
      <th>z</th>
      <td><p>A vector with the smoothing variable.</p></td>
    </tr>
    <tr>
      <th>ez</th>
      <td><p>(optional) A scalar or vector with the smoothing values. If 
values are included then the vector z is used.</p></td>
    </tr>
    <tr>
      <th>bw</th>
      <td><p>A numeric vector.</p></td>
    </tr>
    <tr>
      <th>Sigma</th>
      <td><p>An array.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>A matrix.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>A numeric vector.</p></td>
    </tr>
    <tr>
      <th>est</th>
      <td><p>The nonparametric estimation method, one of "lc" (default) for linear constant
or "ll" for local linear.</p></td>
    </tr>
    <tr>
      <th>tkernel</th>
      <td><p>A character, either "Triweight" (default), "Epa" or "Gaussian" kernel function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>tvGLS</code> returns a list containing:</p>
<dt>coefficients</dt><dd><p>An array of dimension obs x nvar x neq (obs = number of observations, nvar = number of variables
in each equation, neq = number of equations in the system) with the time-varying coefficients estimates.</p></dd>
<dt>fitted</dt><dd><p>A matrix of dimension obs x neq with the fitted values from the estimation.</p></dd>
<dt>residuals</dt><dd><p>A matrix of dimension obs x neq with the residuals from the estimation.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The classical GLS estimator must be modified to generate a set of coefficients changing over time.
The <code>tvGLS</code> finds a GLS estimate at a given point in time <em>t</em> using the data near by.
The size of the data window used is given by the bandwidth. The closest a point is to <em>t</em>,
the larger is its effect on the estimation which is given by the kernel. In this programme,
the three possible kernels are the Triweight, Epanechnikov and Gaussian. As in the classical GLS, the covariance
matrix is involved in the estimation formula. If this matrix is NULL or the identity, then the
program returns the OLS estimates for time-varying coefficients.</p>
<p>Note, that unless with the tvSURE, the tvGLS may run with one common bandwidth for all
equations or with a different bandwidths for each equation.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>FF5F</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>## SMALL/LoBM porfolios time-varying three factor model</span></span>
<span class='r-in'><span class='va'>x</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span> <span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>314</span><span class='op'>)</span>, <span class='va'>FF5F</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NA.Mkt.RF"</span>, <span class='st'>"NA.SMB"</span>,  <span class='st'>"NA.HML"</span>, <span class='st'>"NA.RMW"</span>, <span class='st'>"NA.CMA"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span> <span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>314</span><span class='op'>)</span>, <span class='va'>FF5F</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"JP.Mkt.RF"</span>, <span class='st'>"JP.SMB"</span>,  <span class='st'>"JP.HML"</span>, <span class='st'>"JP.RMW"</span>, <span class='st'>"JP.CMA"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span> <span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>314</span><span class='op'>)</span>, <span class='va'>FF5F</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AP.Mkt.RF"</span>, <span class='st'>"AP.SMB"</span>,  <span class='st'>"AP.HML"</span>, <span class='st'>"AP.RMW"</span>, <span class='st'>"AP.CMA"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x</span><span class='op'>[[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span> <span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>314</span><span class='op'>)</span>, <span class='va'>FF5F</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EU.Mkt.RF"</span>, <span class='st'>"EU.SMB"</span>,  <span class='st'>"EU.HML"</span>, <span class='st'>"EU.RMW"</span>, <span class='st'>"EU.CMA"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##Returns</span></span>
<span class='r-in'><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>FF5F</span><span class='op'>$</span><span class='va'>NA.SMALL.LoBM</span>, <span class='va'>FF5F</span><span class='op'>$</span><span class='va'>JP.SMALL.LoBM</span>, <span class='va'>FF5F</span><span class='op'>$</span><span class='va'>AP.SMALL.LoBM</span>, </span>
<span class='r-in'><span class='va'>FF5F</span><span class='op'>$</span><span class='va'>EU.SMALL.LoBM</span><span class='op'>)</span> </span>
<span class='r-in'><span class='co'>##Excess returns</span></span>
<span class='r-in'><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>FF5F</span><span class='op'>$</span><span class='va'>NA.RF</span>, <span class='va'>FF5F</span><span class='op'>$</span><span class='va'>JP.RF</span>, <span class='va'>FF5F</span><span class='op'>$</span><span class='va'>AP.RF</span>, <span class='va'>FF5F</span><span class='op'>$</span><span class='va'>EU.RF</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>##I fit the data with one bandwidth for each equation</span></span>
<span class='r-in'><span class='va'>FF5F.fit</span> <span class='op'>&lt;-</span> <span class='fu'>tvGLS</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, bw <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.03</span>, <span class='fl'>0.44</span>, <span class='fl'>0.69</span>, <span class='fl'>0.31</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Isabel Casas, Ruben Fernandez-Casal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Time-Varying Seemingly Unrelated Regression Equations Model — tvSURE • tvReg</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Time-Varying Seemingly Unrelated Regression Equations Model — tvSURE" />

<meta property="og:description" content="Fits a set of balanced linear structural equations using Time-varying Ordinary Least 
Squares (tvOLS), Time-varying Seemingly Unrelated Regression (tvGLS), when the error 
variance-covariance matrix is known, or Time-varying Feasible Seemingly Unrelated 
Regression (tvFGLS), when the error variance-covariance matrix is unknown." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tvReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tvReg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/icasas/tvReg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Time-Varying Seemingly Unrelated Regression Equations Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/icasas/tvReg/blob/master/R/tvSURE.R'><code>R/tvSURE.R</code></a></small>
    <div class="hidden name"><code>tvSURE.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fits a set of balanced linear structural equations using Time-varying Ordinary Least 
Squares (tvOLS), Time-varying Seemingly Unrelated Regression (tvGLS), when the error 
variance-covariance matrix is known, or Time-varying Feasible Seemingly Unrelated 
Regression (tvFGLS), when the error variance-covariance matrix is unknown.</p>
    
    </div>

    <pre class="usage"><span class='fu'>tvSURE</span>(<span class='no'>formula</span>, <span class='kw'>z</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ez</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>bw</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>data</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"tvOLS"</span>, <span class='st'>"tvFGLS"</span>, <span class='st'>"tvGLS"</span>), <span class='kw'>Sigma</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>est</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"lc"</span>,
  <span class='st'>"ll"</span>), <span class='kw'>tkernel</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"Epa"</span>, <span class='st'>"Gaussian"</span>), <span class='kw'>bw.cov</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>singular.ok</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>R</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='tvReg-internals.html'>tvsure.control</a></span>(<span class='no'>...</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A list of formulas, one for each equation.</p></td>
    </tr>
    <tr>
      <th>z</th>
      <td><p>A vector containing the smoothing variable.</p></td>
    </tr>
    <tr>
      <th>ez</th>
      <td><p>(optional) A scalar or vector with the smoothing estimation values. If 
values are included then the vector <code>z</code> is used.</p></td>
    </tr>
    <tr>
      <th>bw</th>
      <td><p>An opcional scalar or vector of length the number of equations. It represents the bandwidth in
the estimation of trend coefficients. If NULL, it is selected by cross validation.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A matrix or data frame containing variables in the formula.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A character, a matrix of dimensions neq x neq or an array of dimensions obs x neq x neq, where
<code>obs</code> is the number of observations and <code>neq</code> is the number of equations.
If method = <code>identity</code> or <code>tvOLS</code> (default) then the method used is a time-varying OLS.
If method is a matrix (constant over time) or an array, then the <code>tvGLS</code> is called.
If method = <code>tvFGLS</code>, then the covariance matrix is estimated nonparametrically and the
estimation of the system is done as a whole.</p></td>
    </tr>
    <tr>
      <th>Sigma</th>
      <td><p>A matrix of dimensions neq x neq or an array of dimensions neq x neq x obs
(neq = number of equations, obs = number of observations). It represents
the covariance matrix of the error term. Only necessary for method <code>tvGLS</code>.</p></td>
    </tr>
    <tr>
      <th>est</th>
      <td><p>The nonparametric estimation method, one of "lc" (default) for linear constant or "ll" for local linear.</p></td>
    </tr>
    <tr>
      <th>tkernel</th>
      <td><p>The type of kernel used in the coefficients estimation method, one of Epanesnikov ("Epa") or "Gaussian".</p></td>
    </tr>
    <tr>
      <th>bw.cov</th>
      <td><p>An optional scalar. It represents the bandwidth in the "lc" nonparametric estimation of the
time-varying covariance matrix. If NULL, it is selected by cross validation.</p></td>
    </tr>
    <tr>
      <th>singular.ok</th>
      <td><p>Logical. If FALSE, a singular model is an error.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>An optional nrest x nvar x neq (nrest =  number of restrictions, nvar = number of variables in each equation,
neq = number of equations).</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>An optional vector of length the number of restrictions. By default it contains zeros.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>list of control parameters.  The default is constructed by
the function <code><a href='tvReg-internals.html'>tvsure.control</a></code>.  See the documentation of
<code><a href='tvReg-internals.html'>tvsure.control</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters passed to specific methods.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>tvSURE</code> returns a list of the class <code>tvsure</code> containing the results of the whole system, results of the estimation
and confidence instervals if chosen.
The object of class <code>tvsure</code> have the following components:</p>
<dt>tvcoef</dt><dd><p>An array of dimension obs x nvar x neq (obs = number of observations, nvar = number of variables
in each equation, neq = number of equations in the system) with the time-varying coefficients estimates.</p></dd>
<dt>Lower</dt><dd><p>If <code>level</code> non equal zero, an array of dimension obs x nvar x neq containing the confidence 
interval lower band.</p></dd>
<dt>Upper</dt><dd><p>If <code>level</code> non equal zero, an array of dimension obs x nvar x neq containing the confidence 
interval upper band.</p></dd>
<dt>Sigma</dt><dd><p>An array of dimension obs x neq x neq with the estimates of the errors covariance matrix.</p></dd>
<dt>fitted</dt><dd><p>The fitted values.</p></dd>
<dt>residuals</dt><dd><p>Estimation residuals.</p></dd>
<dt>x</dt><dd><p>A list with the regressors data.</p></dd>
<dt>y</dt><dd><p>A matrix with the dependent variable data.</p></dd>
<dt>z</dt><dd><p>A vector with the smoothing variable.</p></dd>
<dt>ez</dt><dd><p>A vector with the smoothing estimation values.</p></dd>
<dt>bw</dt><dd><p>Bandwidth of mean estimation.</p></dd>
<dt>obs</dt><dd><p>Integer specifying the number of observations in each equation (balanced sample).</p></dd>
<dt>neq</dt><dd><p>Integer specifying the number of equations.</p></dd>
<dt>nvar</dt><dd><p>Vector of integers specifying the number of variables in each equation.</p></dd>
<dt>method</dt><dd><p>Estimation method.</p></dd>
<dt>est</dt><dd><p>Nonparemtric estimation methodology.</p></dd>
<dt>tkernel</dt><dd><p>Kernel type.</p></dd>
<dt>bw.cov</dt><dd><p>Bandwidht of Sigma estimation.</p></dd>
<dt>level</dt><dd><p>Confidence interval range.</p></dd>
<dt>runs</dt><dd><p>Number of bootstrap replications.</p></dd>
<dt>tboot</dt><dd><p>Type of bootstrap.</p></dd>
<dt>BOOT</dt><dd><p>List with all bootstrap replications of <code>tvcoef</code>, if done.</p></dd>
<dt>R</dt><dd><p>Restrictions matrix.</p></dd>
<dt>r</dt><dd><p>Restrictions vector.</p></dd>
<dt>formula</dt><dd><p>Initial formula.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function wraps up the kernel smoothing "tvOLS" and "tvGLS" estimators. The former is used when
equations are considered independent while the later assumes that the error term is correlated
amongst equations. This relation is given in matrix "Sigma" which is used in the estimation. When
"Sigma" is known, the estimates are calculated via the "tvGLS", and via the "tvFGLS" when "Sigma"
is unknown and must be estimated.</p>
<p>Bandwidth selection is of great importance in kernel smoothing methodologies and it is done
automatically by cross-validation. One important aspect in the current packages is that the
bandwidth is selected independently for each equation and then the average is taken to use the
same bandwidth for each equation. It has been shown in Casas et al. (2017) that using
different bandwidths for each equation is in general a bad practice, even for uncorrelated equations.
Even though, the user may be able to use different bandwidths calling functions <code><a href='bw.html'>bw</a></code> and
<code><a href='tvGLS.html'>tvGLS</a></code> separatedly.</p>
<p>A system consists of "neq" number of equations with "obs" number of observations each and a number of
variables not necessarily equal for all equations. The matrix notation is:
$$Y_{t} = X_t \beta_{t}+u_{t}$$
where \(Y_t  = (y_{1t}, y_{2t}, \ldots, y_{neq t})'\), \(X_t = diag (x_{1t}, x_{2t}, \ldots, x_{neq t})\)
and \(\beta_{t} = \left(\beta _{1t}', \ldots, \beta _{neq t}'\right)'\) is a vector of order the
total number of variables in the system. The error vector \(u_{t} = (u_{1t}, u_{2t}, \ldots, u_{neq t})'\)
has zero mean and  covariance matrix \(E(u_t u_t') = \Sigma_t\).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Casas, I., Ferreira, E., and Orbe, S. (2017) Time-Varying Coefficient Estimation 
in SURE Models: Application to Portfolio Management. Available at SSRN: 
https://ssrn.com/abstract=3043137</p>
<p>Chen, X. B., Gao, J., Li, D., and Silvapulle, P (2017) Nonparametric Estimation and 
Forecasting for Time-Varying Coefficient Realized Volatility Models.
<em>Journal of Business \&amp; Economic Statistics</em>, pp.1-13</p>
<p>Granger, C. W (2008) Non-Linear Models: Where Do We Go Next - Time Varying
Parameter Models? <em>Studies in Nonlinear Dynamics \&amp; Econometrics</em>, 12, pp. 1-11.</p>
<p>Kristensen, D (2012) Non-parametric detection and estimation of structural change.
<em>Econometrics Journal</em>, 15, pp. 420-461.</p>
<p>Orbe, S., Ferreira, E., and Rodriguez-Poo, J (2004) On the estimation and testing of
time varying constraints in econometric models, <em>Statistica Sinica</em>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='bw.html'>bw</a></code>, <code><a href='tvCov.html'>tvCov</a></code>,  <code><a href='tvVAR.html'>tvVAR</a></code>, 
<code><a href='https://www.rdocumentation.org/packages/stats/topics/confint'>confint</a></code>, <code><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></code>, <code><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></code> and <code><a href='summary.tvReg.html'>summary</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"Kmenta"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"systemfit"</span>)
<span class='no'>eqDemand</span> <span class='kw'>&lt;-</span> <span class='no'>consump</span> ~ <span class='no'>price</span> + <span class='no'>income</span>
<span class='no'>eqSupply</span> <span class='kw'>&lt;-</span> <span class='no'>consump</span> ~ <span class='no'>price</span> + <span class='no'>farmPrice</span> + <span class='no'>trend</span>
<span class='no'>system</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>demand</span> <span class='kw'>=</span> <span class='no'>eqDemand</span>, <span class='kw'>supply</span> <span class='kw'>=</span> <span class='no'>eqSupply</span>)
<span class='no'>eqSupply2</span> <span class='kw'>&lt;-</span> <span class='no'>consump</span> ~  <span class='no'>price</span> + <span class='no'>farmPrice</span>
<span class='no'>system2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>demand</span> <span class='kw'>=</span> <span class='no'>eqDemand</span>, <span class='kw'>supply</span> <span class='kw'>=</span> <span class='no'>eqSupply2</span>)

<span class='co'>##OLS estimation of a system</span>
<span class='no'>ols.fit</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>systemfit</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/systemfit/topics/systemfit'>systemfit</a></span>(<span class='no'>system</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"OLS"</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Kmenta</span>)
<span class='co'>##tvOLS estimation of a system with the local linear estimator</span>
<span class='co'>##removing trend because it is included in the intercept changing over time</span>
<span class='no'>tvols.fit</span> <span class='kw'>&lt;-</span> <span class='fu'>tvSURE</span>(<span class='no'>system2</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Kmenta</span>,  <span class='kw'>est</span> <span class='kw'>=</span> <span class='st'>"ll"</span>)

<span class='co'>##SUR estimation</span>
<span class='no'>fgls1.fit</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>systemfit</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/systemfit/topics/systemfit'>systemfit</a></span>(<span class='no'>system</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Kmenta</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"SUR"</span>)
<span class='co'>##tvSURE estimation</span>
<span class='no'>tvfgls1.fit</span> <span class='kw'>&lt;-</span> <span class='fu'>tvSURE</span>(<span class='no'>system</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Kmenta</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"tvFGLS"</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Isabel Casas, Ruben Fernandez-Casal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>


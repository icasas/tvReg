<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tvReg: Time-Varying Coefficient Linear Regression for Single and Multi-Equations in R • tvReg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tvReg: Time-Varying Coefficient Linear Regression for Single and Multi-Equations in R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tvReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tvReg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/icasas/tvReg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>tvReg: Time-Varying Coefficient Linear Regression for Single and Multi-Equations in R</h1>
                        <h4 class="author">Isabel Casas</h4>
            <address class="author_afil">
      The University of Southern Denmark.<br><h4 class="author">Ruben Fernandez-Casal</h4>
            <address class="author_afil">
      University of A Coruna<br><h4 class="date">2019-04-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/icasas/tvReg/blob/master/vignettes/tvReg.Rmd"><code>vignettes/tvReg.Rmd</code></a></small>
      <div class="hidden name"><code>tvReg.Rmd</code></div>

    </address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      The source code of the <em>tvReg</em> package is publicly available for download from the Comprehensive <em>R</em> Archive Network (CRAN, <a href="https://CRAN.R-project.org/" class="uri">https://CRAN.R-project.org/</a>). The five basic functions in this package are <em>tvLM</em>, <em>tvAR</em>, <em>tvSURE</em>, <em>tvVAR</em> and <em>tvIRF</em>. Moreover, this package provides the <em>confint</em>, <em>fitted</em>, <em>forecast</em>, <em>plot</em>, <em>predict</em>, <em>print</em>, <em>resid</em> and <em>summary</em> methods adapted to the class attributes of the <em>tvReg</em>. In addition, it includes a bandwidth selection method, a time-varying variance-covariance estimator and two estimation procedures: the time-varying ordinary least squares, which is implemented in the <em>tvOLS</em> method and the time-varying generalised least squares, which is implemented in the <em>tvGLS</em> method.
    </div>
    
<div id="single-equation-models-the-tv-lm-and-tv-ar" class="section level1">
<h1 class="hasAnchor">
<a href="#single-equation-models-the-tv-lm-and-tv-ar" class="anchor"></a>Single equation models: the TV-LM and TV-AR</h1>
<p>The general formula of these models is: <span class="math display">\[
y_t = X_t' \beta_t + u_t,  \hspace{0.3cm} t = 1, \ldots, T  \ \ \ (1)
\]</span> where <span class="math inline">\(X_t = (X_{0t}, X_{1t}, \ldots, X_{dt})'\)</span> and <span class="math inline">\(\beta_t = (\beta_{0t}, \beta_{1t}, \ldots, \beta_{dt})'\)</span> are vectors and <span class="math inline">\(u_t\)</span> is a random variable. When <span class="math inline">\(X_t\)</span> contains lags of <span class="math inline">\(y_t\)</span> then we have the time-varying coefficients AR model (TV-AR) which is fitted by function <em>tvAR</em>. When <span class="math inline">\(X_t\)</span> contains only exogenous variables, then the model is denoted by TV-LM and it is fitted by function <em>tvLM</em>.</p>
<div id="standard-usage-of-tvlm" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-usage-of-tvlm" class="anchor"></a>Standard usage of <em>tvLM</em>
</h2>
<p>Function <em>tvLM</em> fits a TV-LM to the data using the <em>tvOLS</em> method in the estimation. The only mandatory argument is <em>formula</em> which should be a single formula for a single equation model. This formula follows the standard regression formula in <em>R</em> (see documentation of <em>formula</em>). An object of the class attribute <em>tvlm</em> is returned.</p>
<p>The following example demonstrates the functionality of <em>tvLM</em> on generated data and compares it with the <em>lm</em> estimation. The latter assumes that the model coefficients are constant. The data generating process of the example below has time-varying coefficients and therefore its estimation with function <em>lm</em> will only find a central value of the time-varying coefficients.</p>
<p>We want to estimate the following model: <span class="math display">\[
y_t  = \beta_{1t} X_{1t}+ \beta_{2t} X_{2t} + u_t, \ \ t = 1, \ldots, T,
\]</span> where the coefficients are functions of a rescaled time period <span class="math inline">\(\tau = t/T\)</span> with <span class="math inline">\(T = 1000\)</span>. In particular, <span class="math inline">\(\beta_{1t}= \sin(2\pi\tau)\)</span> and <span class="math inline">\(\beta_{2t} = 2\tau\)</span>. The regressors, <span class="math inline">\(X_{1t} \sim N(0, 1)\)</span> and <span class="math inline">\(X_{2t} \sim \chi^2(4)\)</span>, are independent of the error term, <span class="math inline">\(u_t \sim t(10)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Simulate a linear process with time-varying coefficient as functions of
## rescaled time period.
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tvReg)
tau &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)<span class="op">/</span><span class="dv">1000</span>
beta &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">beta1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>tau), <span class="dt">beta2 =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>tau)
X1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1000</span>)
X2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Chisquare">rchisq</a></span>(<span class="dv">1000</span>, <span class="dt">df =</span> <span class="dv">4</span>)
error &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/TDist">rt</a></span>(<span class="dv">1000</span>, <span class="dt">df =</span> <span class="dv">10</span>)
y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(X1, X2) <span class="op">*</span><span class="st"> </span>beta, <span class="dv">1</span>, sum) <span class="op">+</span><span class="st"> </span>error
data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">y =</span> y, <span class="dt">X1 =</span> X1, <span class="dt">X2 =</span> X2)

## Estimate coefficients with lm and tvLM for comparison
coef.lm &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">data =</span> data)<span class="op">$</span>coef
model.tvLM &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvLM.html">tvLM</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">data =</span> data)</code></pre></div>
<pre><code>## Calculating regression bandwidth...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot the estimates of beta1
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(tau, beta[, <span class="dv">1</span>], <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(beta[<span class="dv">1</span>]), <span class="dt">xlab =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(tau), 
    <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(beta[, <span class="dv">1</span>], model.tvLM<span class="op">$</span>tvcoef[, <span class="dv">1</span>]))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h =</span> coef.lm[<span class="dv">1</span>], <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(tau, model.tvLM<span class="op">$</span>tvcoef[, <span class="dv">1</span>], <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="st">"topright"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(beta[<span class="dv">1</span>]), <span class="st">"lm"</span>, <span class="st">"tvlm"</span>), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">bty =</span> <span class="st">"n"</span>, 
    <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</code></pre></div>
<p><img src="tvReg_files/figure-html/tvLM-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The first line loads the <em>tvReg</em> package. Then data is simulated and a data frame is created with the dependent variable and the regressors. Estimations of this model are obtained with the <em>lm</em> and the <em>tvLM</em> functions for comparison. As we see in the plot, the estimation assuming a constant <span class="math inline">\(\beta_{1t}\)</span> lays in the middle of all the values of <span class="math inline">\(\beta_{1t}\)</span>, while the estimation assuming time-varying coefficients is more accurate and closer to the true values.</p>
<p>Package <em>tvReg</em> calculates the confidence intervals the class attributes <em>tvlm</em>, <em>tvar</em>, <em>tvsure</em> and <em>tvirf</em> with the <em>confint</em> method. The argument <em>level</em> is set to 0.95 (95% confidence interval) by default. If this argument is chosen to be a number between 0 and 1, then a number of <em>runs</em> resamples is used in the confidence interval calculation. Because coefficients are time-varying, only wild bootstrap residual resampling is possible. Two choices of wildbootstrap are available in argument <em>tboot</em>, the Mammen (1993) (default) and the one using the normal distribution (tboot =“wild2”).</p>
<p>Note that the input model in the <em>confint</em> method has already confidence intervals, the calculation of another confidence interval will be faster as the results from replications are stored in variable <em>BOOT</em>. Below the code to calculate the 90% and 95% coefficient confidence intervals for the <em>model.tvLM</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Obtain the 90% confidence interval of the coefficients for an object of
## the class attribute tvlm
model.tvLM.<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/confint">confint</a></span>(model.tvLM, <span class="dt">level =</span> <span class="fl">0.9</span>, <span class="dt">runs =</span> <span class="dv">50</span>)

## Obtain the 95% confidence interval of the same object. This will reused
## the resamples of object model.tvLM.90. So the second confidence interval
## calculation is faster
model.tvLM.<span class="dv">95</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/confint">confint</a></span>(model.tvLM.<span class="dv">90</span>)</code></pre></div>
<p>There is a plot method for objects of the five class attributes in this package. The variable coefficients estimates, as well as if confidence intervals if calculated, are plotted for the class attributes <em>tvlm</em>, <em>tvar</em>, <em>tvsure</em> and <em>tvirf</em>. The fitted values and the residuals are plotted for the class attribute <em>tvvar</em> because the interpretation of its coefficients is not relevant. Below the <em>plot</em> of <em>model.tvLM.90</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot coefficient estimates and confidence intervals (if calculated) of
## objects of the class attribute tvlm
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model.tvLM.<span class="dv">90</span>)</code></pre></div>
<p><img src="tvReg_files/figure-html/PLOT-1.png" width="576" style="display: block; margin: auto;"><img src="tvReg_files/figure-html/PLOT-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="user-options-of-tvlm" class="section level2">
<h2 class="hasAnchor">
<a href="#user-options-of-tvlm" class="anchor"></a>User options of <em>tvLM</em>
</h2>
<p>The user can provide additional optional arguments to modify the default estimation. All optional arguments are described below:</p>
<div id="smoothing-random-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#smoothing-random-variable" class="anchor"></a>Smoothing random variable</h3>
<p><em>tvLM</em> assumes by default that model coefficients are unknown functions of rescaled time, <span class="math inline">\(\tau = t/T\)</span> and therefore argument <em>z</em> is set to <em>NULL</em> by default. The user can modify this setting by entering a numeric vector in argument <em>z</em> with the values of the random smoothing variable over the corresponding time period. The example below shows this functionality with generated data. The example generating process of function <em>arima.sim</em> from package <em>stats</em> is used in the example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Data generation
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">42</span>)
z &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/arima.sim">arima.sim</a></span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">ar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.8897</span>, <span class="op">-</span><span class="fl">0.4858</span>), <span class="dt">ma =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="fl">0.2279</span>, 
    <span class="fl">0.2488</span>)), <span class="dt">sd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="fl">0.1796</span>))
beta &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">beta1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>z), <span class="dt">beta2 =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>z)
y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(X1, X2) <span class="op">*</span><span class="st"> </span>beta, <span class="dv">1</span>, sum) <span class="op">+</span><span class="st"> </span>error
data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">y =</span> y, <span class="dt">X1 =</span> X1, <span class="dt">X2 =</span> X2, <span class="dt">z =</span> z)

## Coefficients estimation
coef.lm &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">data =</span> data)<span class="op">$</span>coef
model.tvLM2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvLM.html">tvLM</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">z =</span> z, <span class="dt">data =</span> data, <span class="dt">bw =</span> <span class="fl">0.4</span>, <span class="dt">est =</span> <span class="st">"ll"</span>)

## Plotting the estimates of beta1
sort.index &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort.int</a></span>(z, <span class="dt">index.return =</span> <span class="ot">TRUE</span>)<span class="op">$</span>ix
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(z[sort.index], beta[sort.index, <span class="dv">1</span>], <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(beta[<span class="dv">1</span>]), 
    <span class="dt">xlab =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(z[t]), <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(beta[, <span class="dv">1</span>], model.tvLM2<span class="op">$</span>tvcoef[, <span class="dv">1</span>]))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h =</span> coef.lm[<span class="dv">1</span>], <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(z[sort.index], model.tvLM2<span class="op">$</span>tvcoef[sort.index, <span class="dv">1</span>], <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="st">"top"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(beta[<span class="dv">1</span>]), <span class="st">"lm"</span>, <span class="st">"tvLM"</span>), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">bty =</span> <span class="st">"n"</span>, 
    <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="tvReg_files/figure-html/tvLM2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>As expected, the coefficient estimate from <em>lm</em> falls around the mean of all <span class="math inline">\(\beta_{1t}\)</span>. While the <em>tvLM</em> estimates follow the true process closely. Note that if the bandwidth was very large, then the two estimates would be very similar.</p>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<p>Argument <em>data</em> can be used to specify the data frame or matrix with the model variables. If it is not specified, the function searches variables in the global environment or the one attached to the search path.</p>
</div>
<div id="bandwidth" class="section level3">
<h3 class="hasAnchor">
<a href="#bandwidth" class="anchor"></a>Bandwidth</h3>
<p>When argument <em>bw</em> is set to <em>NULL</em> in <em>tvLM</em>, it is automatically selected by leave-one-out cross-validation. This minimisation can be a bit slow for large datasets, and it should be avoided if the user knows the value of the bandwidth for the required problem. The user can enter values in <em>bw</em> to obtain undersmoothed or oversmoothed estimates as needed. As we can see in the previous example, the bandwidth was chosen to 0.4 by the user.</p>
</div>
<div id="kernel-type" class="section level3">
<h3 class="hasAnchor">
<a href="#kernel-type" class="anchor"></a>Kernel type</h3>
<p>The two choices for this argument are <em>tkernel = “Epa”</em> (default) and <em>tkernel =“Gaussian”</em>. The former refers to the Epanechnikov kernel, which is compact in [-1, 1]. The authors do not recommend the use of the Gaussian kernel because in general, it requires more calculations and it is slower.</p>
</div>
<div id="estimation-methodology" class="section level3">
<h3 class="hasAnchor">
<a href="#estimation-methodology" class="anchor"></a>Estimation methodology</h3>
<p>The default estimation methodology is the Nadaraya-Watson or local constant, which is set as (<em>est = “lc”</em>) and it fits a constant at each interval defined by the bandwidth. The argument <em>est = “ll”</em> can be chosen to perform a local linear estimation (i.e., to fit a polynomial of order 1).</p>
</div>
<div id="singular-fit" class="section level3">
<h3 class="hasAnchor">
<a href="#singular-fit" class="anchor"></a>Singular fit</h3>
<p>As the <em>tvOLS</em> method wraps the <em>lm.wfit</em> method, which at default allows the fitting of a low-rank model, and the estimation coefficients can be <em>NA</em>s. The user can change argument <em>singular.ok</em> to <em>FALSE</em>, so the program stops in case of a low-rank model.</p>
</div>
</div>
<div id="standard-usage-of-tvar" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-usage-of-tvar" class="anchor"></a>Standard usage of <em>tvAR</em>
</h2>
<p>A TV-AR model is a special case of TV-LM in which regressors contain lagged variables of the dependent variable, <em>y</em>. The number of lags included depend on the model order <em>p</em>. Other exogenous variables may be included in the model using argument <em>exogen</em>. An intercept is included by default unless the user enters <em>type= “none”</em> into the function call. Econometrically, this function also wraps estimator <em>tvOLS</em> which needs a bandwidth <em>bw</em> that is automatically selected by the leave-one-out cross-validation when the user does not enter any number. An object of the class attribute <em>tvar</em> is returned.</p>
<p>The following examples demonstrates the functionality of <em>tvAR</em> on generated data, and compares it with the output of the <em>ar.ols</em> method from the <em>stats</em> package. Specifically, the following TV-AR(2) process is considered,</p>
<p><span class="math display">\[
y_t  = \beta_{1t} y_{t-1}+ \beta_{2t} y_{t-2} + u_t, \ \ t = 1, \ldots, T,
\]</span> with coefficients <span class="math inline">\(\beta_{1t} = 0.5 \cos(2\pi \tau)\)</span> and <span class="math inline">\(\beta_{2t} = (\tau -0.5)^2\)</span>, where <span class="math inline">\(\tau = t/T\)</span>, and standard normal errors. A random proces of 1000 points is generated, but only the last 500 are used in the estimation to remove the dependency on the initial values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Simulate an tvAR(2) process
tt &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)<span class="op">/</span><span class="dv">1000</span>
beta &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cos</a></span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>tt), (tt <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>)<span class="op">^</span><span class="dv">2</span>)
y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>(<span class="dv">1000</span>)
y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span>
y[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="op">-</span><span class="fl">0.2</span>
## y(t) = beta1(t) y(t-1) + beta2(t) y(t-2) + ut
<span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span><span class="dv">1000</span>) {
    y[t] &lt;-<span class="st"> </span>y[(t <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(t <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)] <span class="op">%*%</span><span class="st"> </span>beta[t, ] <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>)
}
Y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">tail</a></span>(y, <span class="dv">500</span>)

## Coefficient estimates of process Y with ar.ols and tvAR
model.ar.2p &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/ar.ols">ar.ols</a></span>(Y, <span class="dt">aic =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="dv">2</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>, <span class="dt">demean =</span> <span class="ot">FALSE</span>)
model.tvAR.2p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvAR.html">tvAR</a></span>(Y, <span class="dt">p =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">"none"</span>, <span class="dt">est =</span> <span class="st">"ll"</span>)</code></pre></div>
<pre><code>## Calculating regression bandwidth...</code></pre>
<p>The smoothing variable in the chunk above is time. The lines of code below show an example of a TV-AR(1) process whose coefficient is a function of a uniform random variable in [-1, 1]. In particular, <span class="math inline">\(\beta_{1t} = (z_t -0.5)^2\)</span>. It also calculates the coefficient 80% confidence interval and plot the estimates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Simulate a AR(1) process with coefficients depending on z
z &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">2000</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)
beta &lt;-<span class="st"> </span>(z <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>)<span class="op">^</span><span class="dv">2</span>
y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>(<span class="dv">2000</span>)
y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span>
error &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">2000</span>)
## y(t) = beta1(z(t)) y(t-1) + ut
<span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">2000</span>) {
    y[t] &lt;-<span class="st"> </span>y[(t <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)] <span class="op">%*%</span><span class="st"> </span>beta[t] <span class="op">+</span><span class="st"> </span>error[t]
}

## Remove initial conditions effects
Z &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">tail</a></span>(z, <span class="dv">1500</span>)
Y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">tail</a></span>(y, <span class="dv">1500</span>)

## Coefficient estimates of process Y with ar.ols and tvAR
model.ar.1p &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/ar.ols">ar.ols</a></span>(Y, <span class="dt">aic =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="ot">FALSE</span>, <span class="dt">demean =</span> <span class="ot">FALSE</span>)
model.tvAR.1p.z &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvAR.html">tvAR</a></span>(Y, <span class="dt">p =</span> <span class="dv">1</span>, <span class="dt">z =</span> Z, <span class="dt">type =</span> <span class="st">"none"</span>, <span class="dt">est =</span> <span class="st">"ll"</span>)</code></pre></div>
<pre><code>## Calculating regression bandwidth...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 80% confidence interval using normal wild bootstrap for object of the
## class attribute tvar with 200 bootstrap resamples
model.tvAR.<span class="dv">80</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/confint">confint</a></span>(model.tvAR.1p.z, <span class="dt">tboot =</span> <span class="st">"wild2"</span>, <span class="dt">level =</span> <span class="fl">0.8</span>, <span class="dt">runs =</span> <span class="dv">50</span>)

## Plot coefficient estimates of objects of the class attribute tvar.
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model.tvAR.<span class="dv">80</span>)</code></pre></div>
<p><img src="tvReg_files/figure-html/tvAR.z-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The <em>print</em> method only displays the mean of the coeffient estimates over time and the mean of their confidence interval, if calculated. The <em>summary</em> method displays a summary of all coefficient values over the whole time period. It also prints a pseudo-R2 for the class attributes <em>tvlm</em>, <em>tvar</em>, <em>tvsure</em> and <em>tvvar</em>. See how it works below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Summary of model.tvAR.80
<span class="kw"><a href="../reference/summary.tvReg.html">summary</a></span>(model.tvAR.<span class="dv">80</span>)</code></pre></div>
<pre><code>## 
## Call: 
## NULL
## 
## Class: tvlm 
## 
## Summary of time-varying estimated coefficients: 
## ================================================ 
##              y.l1
## Min.    -0.008232
## 1st Qu.  0.064267
## Median   0.258089
## Mean     0.570742
## 3rd Qu.  0.896421
## Max.     2.356847
## 
## LOWER (80%) confidence interval: 
##             y.l1
## Min.    -0.06139
## 1st Qu. -0.01042
## Median   0.17213
## Mean     0.49892
## 3rd Qu.  0.82595
## Max.     2.22137
##            y.l1
## Min.    0.03958
## 1st Qu. 0.12565
## Median  0.34582
## Mean    0.64257
## 3rd Qu. 0.96689
## Max.    2.49258
## 
## Bandwidth:  0.5358
## Pseudo R-squared:  0.6168</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Print of model.tvAR.80
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(model.tvAR.<span class="dv">80</span>)</code></pre></div>
<pre><code>## 
## Class:  tvar 
## 
## Mean of coefficient estimates: 
## =============================== 
##   y.l1 
## 0.5707 
## 
## LOWER (80%): 
##   y.l1 
## 0.4989 
## 
## UPPER (80%): 
##   y.l1 
## 0.6426 
## 
## Bandwidth:  0.5358</code></pre>
</div>
<div id="user-options-of-tvar" class="section level2">
<h2 class="hasAnchor">
<a href="#user-options-of-tvar" class="anchor"></a>User options of <em>tvAR</em>
</h2>
<p>The user can provide additional optional arguments to modify the default estimation. See section ‘User options of <em>tvLM</em>’ to understand the usage of arguments <em>bw</em>, <em>est</em>, <em>tkernel</em> and <em>singular.ok</em>. In addition, the <em>tvAR</em> has the following arguments:</p>
<div id="type" class="section level3">
<h3 class="hasAnchor">
<a href="#type" class="anchor"></a>Type</h3>
<p>The default model contains an intercept (i.e., it has a mean different from zero). The user can set argument <em>type = “none”</em>, so the model has mean zero.</p>
</div>
<div id="autoregressive-model-with-coefficent-restrictions" class="section level3">
<h3 class="hasAnchor">
<a href="#autoregressive-model-with-coefficent-restrictions" class="anchor"></a>Autoregressive model with coefficent restrictions</h3>
<p>An autoregressive process of order <em>p</em> does not necessarily contain all the previous p-lags of <span class="math inline">\(y_t\)</span>. Argument <em>fixed</em>, with the same format as in the function <em>arima</em> from the package <em>stats</em>, permits to impose these restrictions. The order of variables in the model is: intercept (if any), lag 1, lag 2, <span class="math inline">\(\ldots\)</span>, lag p and exogenous variable (if any). By default, the argument <em>fixed</em> is a vector of <em>NA</em>s with length the number of coefficients in the model. The user can enter a vector in the argument <em>fixed</em> with zeros in the positions corresponding to the restricted coefficients.</p>
<p>The example below uses the simulated variable <em>Y</em> from above and fits a TV-AR(6), but only the first, third and sixth lags are considered in the model, the model has an intercept and there are no exogenous variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Estimate only coefficient from odd lags and the intercept
tvAR.6p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvAR.html">tvAR</a></span>(y, <span class="dt">p =</span> <span class="dv">6</span>, <span class="dt">type =</span> <span class="st">"const"</span>, <span class="dt">fixed =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="dv">0</span>, <span class="ot">NA</span>, <span class="dv">0</span>, <span class="ot">NA</span>, <span class="dv">0</span>), 
    <span class="dt">est =</span> <span class="st">"ll"</span>)</code></pre></div>
</div>
</div>
</div>
<div id="multi-equation-linear-models-the-tv-sure-and-tv-var-models" class="section level1">
<h1 class="hasAnchor">
<a href="#multi-equation-linear-models-the-tv-sure-and-tv-var-models" class="anchor"></a>Multi-equation linear models: the TV-SURE and TV-VAR models</h1>
<p>The formula of systems of linear models can be generally express as in (1) with <span class="math inline">\(y_t = (y_{1t}, y_{2t}, \ldots, y_{Mt})'\)</span> for <span class="math inline">\(M\)</span> the number of equations in the system. Similarly, the error term <span class="math inline">\(u_t =(u_{1t}, u_{2t}, \ldots, u_{Mt})'\)</span> and the <span class="math inline">\(\Sigma_t\)</span> is the variance-covariance matrix that defines the dependency of the error terms of all equations. Variables <span class="math inline">\(X_t\)</span> and <span class="math inline">\(\beta_t\)</span> are matrices.</p>
<p>Regarding systems of equations, the <em>tvSURE</em> function fits a time-varying seemingly unrelated equations models. Its main argument is <em>formula</em> which is a list of objects of the class attribute <em>formula</em>, one formula for each equation. Equations may have a different number of regressors and these do not have to be the same.</p>
<p>Another multi-equation model included in the package is the time-varying vector autoregressive in function <em>tvVAR</em> whose main arguments are a matrix of dependent variables <em>y</em> and the number of lags <em>p</em>. It returns an object of the class attribute <em>tvvar</em>. Coefficients of the <em>tvVAR</em> are not interpretable, instead the time-varying coefficients impulse response function is coded in function <em>tvIRF</em>. The latter takes an object of the class attribute <em>tvvar</em> and returns an object of the class attribute <em>tvirf</em>.</p>
<div id="standard-usage-of-the-tvsure" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-usage-of-the-tvsure" class="anchor"></a>Standard usage of the tvSURE</h2>
<p>A time-varying coefficients SURE model is a multi-equation where the regressors are exogenous variables. The main argument of this function is a list of formulas, one for each equation. The <em>formula</em> format is inpired in the formula from package <em>systemfit</em> which estimates parametric multi-equation problems with constant coefficients. An object of the class attribute <em>tvsure</em> is returned by the main function <em>tvSURE</em>.</p>
<p>The examples below use the dataset <em>Kmenta</em> from package <em>systemfit</em> to illustrate a demand/supply problem using different models. This problem has two equations: i) a demand equation, which explains how food consumption per capita, <em>consump</em>, depends on the ratio of food price, <em>price</em>; and disposable income, <em>income</em>; and ii) a supply equation, which shows how consumption depends on <em>price</em>, ratio prices received by farmers to general consumer prices, <em>farmPrice</em>; and a possible time trend, <em>trend</em>. Mathematically, this SURE model is</p>
<span class="math display">\[\begin{align}
consump_t = &amp;\beta_{10} + \beta_{11} price_t + \beta_{12} income_t  + u_{1t}\nonumber\\
consump_t = &amp;\beta_{20} + \beta_{21} price_t+ \beta_{22} farmPrice_t  +\beta_{23} t+  u_{2t}.
\label{eq:Kmenta}
\end{align}\]</span>
<p>The estimation of this multi-equation problem can be done equation by equation, assuming no correlation in the error variance-covariance matrix, or as a system where the information in this matrix is used. Regressors can be different for each equation. An intercept is included by default in each equation unless its <em>formula</em> states it differently. Function <em>tvSURE</em> is a wrapper of the two estimation procedures. Estimator <em>tvOLS</em> is used by default, calculating estimates for each equation independently with different bandwidths <em>bw</em>. The user is able to enter a set of bandwidths or a single bandwidth to be used in the estimation instead. In addition, estimator <em>tvGLS</em> is used when equations are assumed to be related by the variance-covariance matrix of the error. In addition, confidence intervals of the estimates can be calculated. Results can be plotted and summarise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"Kmenta"</span>, <span class="dt">package =</span> <span class="st">"systemfit"</span>)
eqDemand &lt;-<span class="st"> </span>consump <span class="op">~</span><span class="st"> </span>price <span class="op">+</span><span class="st"> </span>income
eqSupply &lt;-<span class="st"> </span>consump <span class="op">~</span><span class="st"> </span>price <span class="op">+</span><span class="st"> </span>farmPrice <span class="op">+</span><span class="st"> </span>trend
system &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">demand =</span> eqDemand, <span class="dt">supply =</span> eqSupply)

## OLS estimation of a system
model.ols &lt;-<span class="st"> </span>systemfit<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/systemfit/topics/systemfit">systemfit</a></span>(system, <span class="dt">method =</span> <span class="st">"OLS"</span>, <span class="dt">data =</span> Kmenta)

## tvOLS estimation of a system with the local linear estimator
model.tvOLS &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvSURE.html">tvSURE</a></span>(system, <span class="dt">data =</span> Kmenta, <span class="dt">est =</span> <span class="st">"ll"</span>)</code></pre></div>
<pre><code>## Calculating regression bandwidth...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 50% confidence interval using Mammen's wild bootstrap for object of the
## class attribute tvsure
model.tvOLS &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/confint">confint</a></span>(model.tvOLS, <span class="dt">level =</span> <span class="fl">0.5</span>, <span class="dt">runs =</span> <span class="dv">30</span>)

## Plot coefficient estimates and confidence intervals (if calculated) of
## objects of the class attribute tvsure
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model.tvOLS)</code></pre></div>
<p><img src="tvReg_files/figure-html/tvOLS-1.png" width="576" style="display: block; margin: auto;"><img src="tvReg_files/figure-html/tvOLS-2.png" width="576" style="display: block; margin: auto;"><img src="tvReg_files/figure-html/tvOLS-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Print of model model.tvOLS
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(model.tvOLS)</code></pre></div>
<pre><code>## 
## Class:  tvsure 
## 
## Mean of TV-SURE coefficient estimates for equation "demand": 
## ============================================================= 
## (Intercept).demand       price.demand      income.demand 
##           108.0830            -0.4338             0.3705 
## 
## Bandwidth:  1.5
## 
## 
## Mean of TV-SURE coefficient estimates for equation "supply": 
## ============================================================= 
## (Intercept).supply       price.supply   farmPrice.supply 
##          -40.78078            0.29243            0.07264 
##       trend.supply 
##          110.46391 
## 
## Bandwidth:  1.8</code></pre>
</div>
<div id="user-options-of-tvsure" class="section level2">
<h2 class="hasAnchor">
<a href="#user-options-of-tvsure" class="anchor"></a>User options of <em>tvSURE</em>
</h2>
<p>The user can provide additional optional arguments to modify the default estimation. Refer to section ‘User options of <em>tvLM</em>’ to understand the usage of arguments <em>z</em>, <em>data</em>, <em>bw</em>, <em>est</em>, <em>tkernel</em> and <em>singular.ok</em>. Note that the current version only allows one single random variable <em>z</em> for all equations. The <em>tvSURE</em> function wraps estimators <em>tvOLS</em> and <em>tvGLS</em>.</p>
<div id="choosing-the-estimation-method" class="section level3">
<h3 class="hasAnchor">
<a href="#choosing-the-estimation-method" class="anchor"></a>Choosing the estimation method</h3>
<p>This argument defines the type of estimation to be performed. The possible choices in argument <em>method</em> are:</p>
<ol style="list-style-type: decimal">
<li><p>“tvOLS” for a line by line estimation, meaning that the error variance-covariance matrix, <span class="math inline">\(\Sigma\)</span>, is the identity matrix.</p></li>
<li><p>“tvGLS” to estimate the coefficients of the system using <span class="math inline">\(\Sigma_t\)</span>, for which the user must enter it in argument <em>Sigma</em>. Argument <em>Sigma</em> takes either a symmetric <em>matrix</em> or an <em>array</em>. If <span class="math inline">\(\Sigma\)</span> is a <em>matrix</em> (constant over time), then it must have dimensions <em>neq</em> <span class="math inline">\(\times\)</span> <em>neq</em>, where <em>neq</em> is the number of equations in the system. If <span class="math inline">\(\Sigma_t\)</span> is considered to change with time, then argument <em>Sigma</em> is an <em>array</em> of dimension <em>neq</em> <span class="math inline">\(\times\)</span> <em>neq</em> <span class="math inline">\(\times\)</span> <em>obs</em>, where the last dimension measures the number of time observations. Note that if the user enters a diagonal variance-covariance matrix with diagonal values different from one, then a time-varying weighted least squares is performed. If <em>method = “tvGLS”</em> is entered but <em>Sigma = NULL</em>, then <em>tvSURE</em> is fitted as if  and a warning is issued.</p></li>
<li><p>“tvFGLS” to estimate the coefficients of the system using an estimated time-varying variance-covariance matrix. By default, only one iteration is performed in the estimation of <span class="math inline">\(\Sigma\)</span>, unless <em>control</em> indicates otherwise. The user can choose the maximum number of iterations or the level of tolerance in the estimation of <span class="math inline">\(\Sigma\)</span>.</p></li>
</ol>
<p>The lines of code below illustrate the use of arguments <em>method</em> and <em>control</em> and compares it with the usage of these arguments in function <em>systemfit</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## FGLS estimation - SURE estimation
fgls1.fit &lt;-<span class="st"> </span>systemfit<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/systemfit/topics/systemfit">systemfit</a></span>(system, <span class="dt">data =</span> Kmenta, <span class="dt">method =</span> <span class="st">"SUR"</span>)

## tvFGLS estimation - tvSURE estimation
tvfgls1.fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvSURE.html">tvSURE</a></span>(system, <span class="dt">data =</span> Kmenta, <span class="dt">method =</span> <span class="st">"tvFGLS"</span>)</code></pre></div>
<pre><code>## Calculating regression bandwidth...
## Calculating variance-covariance estimation bandwidth...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Iterative FGLS estimation - SUR estimation
fgls2.fit &lt;-<span class="st"> </span>systemfit<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/systemfit/topics/systemfit">systemfit</a></span>(system, <span class="dt">data =</span> Kmenta, <span class="dt">method =</span> <span class="st">"SUR"</span>, <span class="dt">maxit =</span> <span class="dv">100</span>)

## Iterative tvFGLS estimation - SURE estimation using the local linear
tvfgls2.fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvSURE.html">tvSURE</a></span>(system, <span class="dt">data =</span> Kmenta, <span class="dt">method =</span> <span class="st">"tvFGLS"</span>, <span class="dt">control =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">tol =</span> <span class="fl">0.001</span>, 
    <span class="dt">maxiter =</span> <span class="dv">100</span>))</code></pre></div>
<pre><code>## Calculating regression bandwidth...
## Calculating variance-covariance estimation bandwidth...</code></pre>
</div>
<div id="coefficient-restrictions" class="section level3">
<h3 class="hasAnchor">
<a href="#coefficient-restrictions" class="anchor"></a>Coefficient restrictions</h3>
<p>The user can restrict certain coefficients using arguments <em>R</em> and <em>r</em>. Note that the restriction is setting those coefficients to a constant. Restrictions can aid statistical inference to test certain conditions. Matrix <em>R</em> has as many rows as restrictions in <em>r</em> and as many columns as regressors in the model. In this case, Model () has 7 coefficients which are ordered as they appear in the list of formulas. Note that the time-varying coefficient of the variable <em>trend</em> is redundant when an intercept is included in the second equation of the TV-SURE. Therefore, we want to restrict its coefficient two zero. We would also like to impose <span class="math inline">\(\beta_{11, t} - \beta_{21, t} = 0.5\)</span>:</p>
<p><span class="math display">\[
\left(\begin{array}{ccccccc}
0 &amp;0&amp; 0&amp;0&amp;0&amp;0&amp;1\\
0&amp;1&amp;0&amp;0&amp;1&amp;0&amp;0 \end{array}\right)  \left(\begin{array}{c} \beta_{10, t} \\ \beta_{11,t} \\\beta_{12, t}\\\beta_{20,t} \\\beta_{21, t} \\\beta_{22,t} \\ \beta_{23, t} \\ \end{array}\right) =  \left(\begin{array}{c} 0 \\0.5 \end{array}\right) 
\]</span></p>
<p>This is done with the  as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Estimation with 2 restrictions
Rrestr &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">7</span>)
Rrestr[<span class="dv">1</span>, <span class="dv">7</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
Rrestr[<span class="dv">2</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
Rrestr[<span class="dv">2</span>, <span class="dv">5</span>] &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">1</span>
qrestr &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.5</span>)
tvfgls.rest &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvSURE.html">tvSURE</a></span>(system, <span class="dt">data =</span> Kmenta, <span class="dt">method =</span> <span class="st">"tvFGLS"</span>, <span class="dt">R =</span> Rrestr, 
    <span class="dt">r =</span> qrestr, <span class="dt">bw =</span> tvfgls1.fit<span class="op">$</span>bw, <span class="dt">bw.cov =</span> tvfgls1.fit<span class="op">$</span>bw.cov)</code></pre></div>
</div>
</div>
<div id="standard-usage-of-tvvar-and-tvirf" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-usage-of-tvvar-and-tvirf" class="anchor"></a>Standard usage of <em>tvVAR</em> and <em>tvIRF</em>
</h2>
<p>A time-varying coefficients vector autoregressive (TV-VAR) model is a system of TV-AR models. The dependent variable, <em>y</em>, is a matrix with as many columns as equations. Regressors are often the same for each equation and they consist of the lagged values of <em>y</em>, where the number of lags is given in argument <em>p</em>; an intercept if argument <em>type=“const”</em> and other exogenous variables entered in argument <em>exogen</em>. Econometrically, the <em>tvOLS</em> is called to calculate the estimates for each equation independently using one bandwidth per equation. The user can enter a single scalar in <em>bw</em> or a vector of scalars, one bandwidth for each equation. If <em>bw = NULL</em>, one bandwidth for each equation is selected by the leave-one-out cross-validation.</p>
<p>As in the other models, the kernel and the estimation methodology can be chosen in arguments <em>tkernel</em> and <em>est</em>. The return is an object of the class attribute <em>tvvar</em> which can be used to estimate the time-varying impulse response function with function <em>tvIRF</em>. The smoothing variable is time by default, but another random variable can be used by entering it in argument <em>z</em>.</p>
<p>Example below uses the macroeconomic data from Primiceri (2005). Three variables are included in dataset <em>usmacro</em> from package <em>bvarsv</em>: inflation rate (<em>inf</em>), unemployment rate (<em>une</em>) and treasury bill interest rate (<em>tbi</em>) for the United States. The mathematical model under study follows the expression of a TV-VAR(4):</p>
<p><span class="math display">\[
\text{inf}_t = a_{t}^1 +\sum_{i=1}^4 b_{it}^ 1 \ \text{inf}_{t-i} +\sum_{i=1}^4 c_{it}^1 \ \text{une}_{t-i} +\sum_{i=1}^4 d_{it}^1\ \text{tbi}_{t-i} +u _{t}^1
\]</span></p>
<p><span class="math display">\[
\text{une}_t = a_{t}^2 +\sum_{i=1}^4 b_{it}^ 2 \ \text{inf}_{t-i} +\sum_{i=1}^4 c_{it}^2 \ \text{une}_{t-i} +\sum_{i=1}^4 d_{it}^2 \ \text{tbi}_{t-i} +u _{t}^2
\]</span></p>
<p><span class="math display">\[
\text{tbi}_t = a_{t}^3 +\sum_{i=1}^4 b_{it}^ 3 \ \text{inf}_{t-i} +\sum_{i=1}^4 c_{it}^3 \ \text{une}_{t-i} +\sum_{i=1}^4 d_{it}^3\ \text{tbi}_{t-i} +u _{t}^3.
\]</span></p>
<p>A constant coefficients VAR(4) is estimated using function <em>VAR</em> from package <em>vars</em> and a TV-VAR(4) is estimated with <em>tvVAR</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Inflation rate, unemployment rate and treasury bill interest rate for the
## US, as used by Primiceri (2005).
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(usmacro, <span class="dt">package =</span> <span class="st">"bvarsv"</span>)
model.VAR &lt;-<span class="st"> </span>vars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/vars/topics/VAR">VAR</a></span>(usmacro, <span class="dt">p =</span> <span class="dv">4</span>, <span class="dt">type =</span> <span class="st">"const"</span>)
model.tvVAR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvVAR.html">tvVAR</a></span>(usmacro, <span class="dt">p =</span> <span class="dv">4</span>, <span class="dt">type =</span> <span class="st">"const"</span>)</code></pre></div>
<pre><code>## Calculating regression bandwidths...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot the fitted values and residuals of each equation in the model
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model.tvVAR)</code></pre></div>
<p><img src="tvReg_files/figure-html/tvVAR-1.png" width="576" style="display: block; margin: auto;"><img src="tvReg_files/figure-html/tvVAR-2.png" width="576" style="display: block; margin: auto;"><img src="tvReg_files/figure-html/tvVAR-3.png" width="576" style="display: block; margin: auto;"></p>
<p>The user can provide additional optional arguments to modify the default estimation. Refer to section ‘User options of <em>tvAR</em>’ to understand the usage of arguments <em>p</em>, <em>z</em>, <em>bw</em>, <em>type</em>, <em>exogen</em>, <em>est</em>, <em>tkernel</em> and <em>singular.ok</em>. Note that the current version only allows one single random variable <em>z</em>, the same for every equation. The <em>tvVAR</em> model wraps estimator <em>tvOLS</em>. At the moment all equations are estimated as if there were independent, i.e. line by line. The variance-covariance matrix in the residuals can be used to calculate the orthogonal time-varying IRF.</p>
</div>
<div id="user-options-of-tvirf" class="section level2">
<h2 class="hasAnchor">
<a href="#user-options-of-tvirf" class="anchor"></a>User options of <em>tvIRF</em>
</h2>
<p>The main argument <em>x</em> is an object of the class attribute <em>tvvar</em> obtained from function <em>tvVAR</em>. The user can provide additional optional arguments to modify the default estimation.</p>
<div id="impulse-and-response-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#impulse-and-response-variables" class="anchor"></a>Impulse and response variables</h3>
<p>The user has the option to pick a subset of impulse variables and/or response variables using arguments <em>impulse</em> and <em>response</em>.</p>
</div>
<div id="horizon" class="section level3">
<h3 class="hasAnchor">
<a href="#horizon" class="anchor"></a>Horizon</h3>
<p>The horizon of the TV-IRF coefficients can be chosen by the user with argument <em>n.ahead</em>, the default is 10.</p>
</div>
<div id="orthogonal-tv-irf" class="section level3">
<h3 class="hasAnchor">
<a href="#orthogonal-tv-irf" class="anchor"></a>Orthogonal TV-IRF</h3>
<p>The <em>tvIRF</em> calculates one impulse response function for each point in time. It is likely that the errors variance-covariance matrix of a process with time-varying coefficients is also time-varying. Those, the default of argument <em>ortho.cov = “tv”</em>. Note that the user can enter a value of the bandwidth for the covariance matrix estimation in <em>bw.cov</em>. This function calls function <em>tvCov</em> in the calculation of the MA (<span class="math inline">\(\infty\)</span>) coefficients. It is possible to use a constant variance-covariance matrix by setting <em>ortho.cov = “const”</em>.</p>
<p>The chunk below shows how to obtain the IRF and TV-IRF from the previous monetary policy example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Estimate a the impulse response functions with irf and tvIRF from previous
## vector autoregressive models
model.irf &lt;-<span class="st"> </span>vars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/vars/topics/irf">irf</a></span>(model.VAR)
model.tvIRF &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvIRF.html">tvIRF</a></span>(model.tvVAR)

## 95% confidence interval using Mammen's wild bootstrap for object of the
## class attribute tvirf
model.tvIRF &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/confint">confint</a></span>(model.tvIRF, <span class="dt">runs =</span> <span class="dv">30</span>)</code></pre></div>
<p>Note that there is one IRF for each point in time. The <em>plot</em> method of class attribute <em>tvirf</em> displays the mean value of all the IRF over all the time period. However, if the user desires to plot the TV-IRF of a particular time, for example value 100 as below, then it is entered in the argument <em>obs.index</em>. This <em>plot</em> method also permits to choose a particular response and impulse variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot the mean all tvIRF over time
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model.tvIRF)</code></pre></div>
<pre><code>## 
## The plot represents the mean of tvIRF over every time period. 
##           Enter the row number in parameter "obs.index" to plot the tvIRF 
##           of a particular point in time.</code></pre>
<p><img src="tvReg_files/figure-html/tvIRF2-1.png" width="576" style="display: block; margin: auto;"><img src="tvReg_files/figure-html/tvIRF2-2.png" width="576" style="display: block; margin: auto;"><img src="tvReg_files/figure-html/tvIRF2-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot the effect of a shock in the interest rates (tbi) on the inflation
## (inf) at time 100
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model.tvIRF, <span class="dt">obs.index =</span> <span class="dv">100</span>, <span class="dt">impulse =</span> <span class="st">"tbi"</span>, <span class="dt">response =</span> <span class="st">"inf"</span>)</code></pre></div>
<p><img src="tvReg_files/figure-html/tvIRF2-4.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="cumulative-tv-irf" class="section level3">
<h3 class="hasAnchor">
<a href="#cumulative-tv-irf" class="anchor"></a>Cumulative TV-IRF</h3>
<p>If the user desires to obtain the cumulative TV-IRF values, then argument <em>cumulative</em> must be set to <em>TRUE</em>. See example below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Estimate a the tvIRF with time-varying covariance function
model.tvIRF2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvIRF.html">tvIRF</a></span>(model.tvVAR, <span class="dt">cumulative =</span> <span class="ot">TRUE</span>)

## Plot the cumulative effect on a shock in short term interest rates (tbi)
## on the inflation (inf)
plot &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model.tvIRF2, <span class="dt">impulse =</span> <span class="st">"tbi"</span>, <span class="dt">response =</span> <span class="st">"inf"</span>)</code></pre></div>
<pre><code>## 
## The plot represents the mean of tvIRF over every time period. 
##           Enter the row number in parameter "obs.index" to plot the tvIRF 
##           of a particular point in time.</code></pre>
<p><img src="tvReg_files/figure-html/tvIRF3-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="estimating-a-time-varying-variance-covariance-matrix" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-a-time-varying-variance-covariance-matrix" class="anchor"></a>Estimating a time-varying variance-covariance matrix</h1>
<p>A time-varying covariance matrix of two or more series can be estimated using function <em>tvCov</em> as in the example below. This is the function used by the <em>tvSURE</em> and <em>tvIRF</em> functions to estimate a time-varying variance-covariance matrix of the error term. The lines of code below illustrate its use.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(MASS)
## Generate two independent (uncorrelated) series
y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">200</span>, <span class="dt">sd =</span> <span class="dv">4</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">200</span>, <span class="dt">sd =</span> <span class="dv">1</span>))
## Calculate the bandwidth
bw.cov &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bwCov.html">bwCov</a></span>(y)
## Estimate variance-variance matrix
Sigma.hat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvCov.html">tvCov</a></span>(y, <span class="dt">bw =</span> bw.cov)
## The first time point estimate
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(Sigma.hat[, , <span class="dv">1</span>])</code></pre></div>
<pre><code>##            [,1]      [,2]
## [1,] 16.8399011 0.2118488
## [2,]  0.2118488 1.1359647</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## The mean over time of all estimates
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(Sigma.hat, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, mean))</code></pre></div>
<pre><code>##            [,1]      [,2]
## [1,] 16.8387330 0.2121967
## [2,]  0.2121967 1.1359955</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generate two dependent variables with a covariance of -0.5
y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">mu =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">Sigma =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">4</span>)))
## Calculate the bandwidth
bw.cov &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bwCov.html">bwCov</a></span>(y)
## Estimation the variables variance-covariance matrix
Sigma.hat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tvCov.html">tvCov</a></span>(y, <span class="dt">bw =</span> bw.cov)
## The first time point estimate
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(Sigma.hat[, , <span class="dv">1</span>])</code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,]  0.8947669 -0.3850036
## [2,] -0.3850036  3.9702421</code></pre>
</div>
<div id="prediction-and-forecast-in-time-varying-coefficient-models" class="section level1">
<h1 class="hasAnchor">
<a href="#prediction-and-forecast-in-time-varying-coefficient-models" class="anchor"></a>Prediction and forecast in time-varying coefficient models</h1>
<p>Estimation is an useful tool to understand the patterns and processes hidden in known data. Prediction and forecasting are the mechanisms to extend this understanding to unknown data.</p>
<p>In a classical linear model, the <em>prediction</em> of the dependent variable at time <span class="math inline">\(T+h\)</span> is <span class="math inline">\(\hat y_{T+h} = x_{T+h}^\top \hat \beta\)</span> for <span class="math inline">\(h\ge 1\)</span>. All predictors, <span class="math inline">\(x_{T+h}\)</span>, are known.</p>
<p>In autoregressive models, the prediction of future values has a slightly different nature and it is commonly referred to as <em>forecast</em>. The predictors (regressors) in the 1-step-ahead forecast are known, but they are unknown for longer horizons. For example, given <span class="math inline">\(y_t = 5 - 0.5 y_{t-1} + u_t\)</span> for <span class="math inline">\(t = 1, \ldots, T\)</span>, the 1-step-ahead forecast is <span class="math inline">\(\hat y_{T+1} = 5 -0.5 y_{T}\)</span> with known <span class="math inline">\(y_T\)</span>. However, the 2-step-ahead forecast is <span class="math inline">\(\hat y_{T+2} = 5 - 0.5 \hat y_{T+1}\)</span> with the previously forecasted <span class="math inline">\(\hat y_{T+1}\)</span> as predictor, which means a larger uncertainty in the forecast error. This means a greater uncertainty in the forecast error as the forecast horizon increases.</p>
<p>In our the time-varying coefficient models, we refer to prediction when the smoothing variable, <span class="math inline">\(z_t\)</span>, is a random variable and to forecast when <span class="math inline">\(z_t = \tau\)</span>. Thus, the <em>predict</em> and <em>forecast</em> methods in <em>tvReg</em> are slightly different.</p>
<div id="usage-of-prediction-and-forecast-in-tvreg" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-of-prediction-and-forecast-in-tvreg" class="anchor"></a>Usage of prediction and forecast in tvReg</h2>
<p>The <em>forecast</em> method is implemented for the class attributes <em>tvlm</em>, <em>tvar</em>, <em>tvvar</em> and <em>tvsure</em>. As an example, the three days ahead forecast of model <em>tvHAR</em>, which is an extension of the HAR model of Corsi (2008) to allow for time-varying coefficients. This is a TV-AR(1) model with two exogenous variables: an average of a weekly realized variance and an average of a monthly week variance. The argument <em>newexogen</em> needs three values for time points 2002, 2003 and 2004 and variable <em>n.ahead</em> is set to three.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(RV)
RV2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(RV, <span class="dv">2001</span>)
## Estimate/train tvHAR model
tvHAR &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/with">with</a></span>(RV2, <span class="kw"><a href="../reference/tvAR.html">tvAR</a></span>(RV, <span class="dt">p =</span> <span class="dv">1</span>, <span class="dt">bw =</span> <span class="dv">20</span>, <span class="dt">exogen =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(RV_week, RV_month)))
## Define the forecast horizon (n.ahead) and the future values of the
## exogenous variables
newexogen &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(RV<span class="op">$</span>RV_week[<span class="dv">2002</span><span class="op">:</span><span class="dv">2004</span>], RV<span class="op">$</span>RV_month[<span class="dv">2002</span><span class="op">:</span><span class="dv">2004</span>])
## 3-step-ahead forecast
<span class="kw"><a href="../reference/forecast.html">forecast</a></span>(tvHAR, <span class="dt">n.ahead =</span> <span class="dv">3</span>, newexogen)</code></pre></div>
<pre><code>## [1] 2.529043e-05 2.457955e-05 2.289168e-05</code></pre>
<p>The <em>forecast</em> method main arguments are <em>object</em> and <em>n.ahead</em>. The latter is a scalar with the forecast horizon. Depending on the class attribute, further arguments may be necessary.</p>
<div id="type-of-forecast" class="section level3">
<h3 class="hasAnchor">
<a href="#type-of-forecast" class="anchor"></a>Type of forecast</h3>
<p>It is possible to run either an increase window forecast (default), when argument <em>winsize = 0</em> or a rolling window forecast with a window size as long as it is defined in argument <em>winsize</em>.</p>
</div>
<div id="newx-newdata" class="section level3">
<h3 class="hasAnchor">
<a href="#newx-newdata" class="anchor"></a>newx, newdata</h3>
<p>These are arguments in the <em>forecast</em> method for class attributes <em>tvlm</em> and <em>tvsure</em>, respectively. They should contain new values of the regressors and have class attributes <em>vector</em>, <em>data.frame</em> or <em>matrix</em>. It is not necessary to enter the intercept.</p>
</div>
<div id="newexogen" class="section level3">
<h3 class="hasAnchor">
<a href="#newexogen" class="anchor"></a>newexogen</h3>
<p>This argument appears in the <em>forecast</em> method for the class attributes <em>tvar</em> and <em>tvvar</em> and it must be entered when the initial model contains <em>exogen</em> variables. It is a <em>vector</em>, <em>data.frame</em> or <em>matrix</em>.</p>
<p>The <em>predict</em> method is implemented for the same four class attribues than the <em>forecast</em> method. It does not require the <em>n.ahead</em> or <em>winsize</em> arguments, but the other arguments are the same. In addition, new values of the smoothing variable must be entered into the argument <em>newz</em>. This is a <em>numeric</em> vector. The code below shows how to predict three future values of the <em>tvHARQ</em> model fitted above. The <em>tvHARQ</em> model has the same variables than the <em>tvHAR</em> model but the coefficients are unknown function of the past realized quarticity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tvHARQ &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/with">with</a></span>(RV2, <span class="kw"><a href="../reference/tvLM.html">tvLM</a></span>(RV <span class="op">~</span><span class="st"> </span>RV_lag <span class="op">+</span><span class="st"> </span>RV_week <span class="op">+</span><span class="st"> </span>RV_month, <span class="dt">z =</span> RQ_lag_sqrt, 
    <span class="dt">bw =</span> <span class="fl">0.006</span>))
newx &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(RV<span class="op">$</span>RV_lag[<span class="dv">2002</span><span class="op">:</span><span class="dv">2004</span>], RV<span class="op">$</span>RV_week[<span class="dv">2002</span><span class="op">:</span><span class="dv">2004</span>], RV<span class="op">$</span>RV_month[<span class="dv">2002</span><span class="op">:</span><span class="dv">2004</span>])
newz &lt;-<span class="st"> </span>RV<span class="op">$</span>RQ_lag_sqrt[<span class="dv">2002</span><span class="op">:</span><span class="dv">2004</span>]
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(tvHARQ, newx, newz)</code></pre></div>
<pre><code>## [1] 2.407101e-05 2.095129e-05 2.328338e-05</code></pre>
<p>The <em>predict</em> method for the rest of the class attributes in the package follow similar patterns and further examples can be found in the documentation of the package.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#single-equation-models-the-tv-lm-and-tv-ar">Single equation models: the TV-LM and TV-AR</a><ul class="nav nav-pills nav-stacked">
<li><a href="#standard-usage-of-tvlm">Standard usage of <em>tvLM</em></a></li>
      <li><a href="#user-options-of-tvlm">User options of <em>tvLM</em></a></li>
      <li><a href="#standard-usage-of-tvar">Standard usage of <em>tvAR</em></a></li>
      <li><a href="#user-options-of-tvar">User options of <em>tvAR</em></a></li>
      </ul>
</li>
      <li>
<a href="#multi-equation-linear-models-the-tv-sure-and-tv-var-models">Multi-equation linear models: the TV-SURE and TV-VAR models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#standard-usage-of-the-tvsure">Standard usage of the tvSURE</a></li>
      <li><a href="#user-options-of-tvsure">User options of <em>tvSURE</em></a></li>
      <li><a href="#standard-usage-of-tvvar-and-tvirf">Standard usage of <em>tvVAR</em> and <em>tvIRF</em></a></li>
      <li><a href="#user-options-of-tvirf">User options of <em>tvIRF</em></a></li>
      </ul>
</li>
      <li><a href="#estimating-a-time-varying-variance-covariance-matrix">Estimating a time-varying variance-covariance matrix</a></li>
      <li>
<a href="#prediction-and-forecast-in-time-varying-coefficient-models">Prediction and forecast in time-varying coefficient models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#usage-of-prediction-and-forecast-in-tvreg">Usage of prediction and forecast in tvReg</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Isabel Casas, Ruben Fernandez-Casal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
